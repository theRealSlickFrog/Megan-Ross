<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Blog Post - Ross Estate Law</title>
	<script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

	<style>
		/* Reset and base styles */
		body {
			background: #0b080c;
			color: #ffffff;
			font-family: 'QuestrialRegular', sans-serif;
			font-size: 16px;
			margin: 0;
			min-width: 940px;
			padding: 0;
		}

		a {
			outline: none;
		}

		img {
			border: 0;
		}

		/* Header */
		#header {
			background: url(images/bg-gray.png) repeat-x left top;
			height: 306px;
			position: relative;
			width: 100%;
			z-index: 2;
		}

		#header div {
			margin: 0 auto;
			width: 940px;
		}

		#header div a.logo {
			background: url(images/dogs.jpg) no-repeat center top;
			display: block;
			height: 306px;
			text-indent: -99999px;
		}

		/* Navigation */
		#navigation {
			background: url(images/bg-gray.png) repeat-x left top;
			border-bottom: 1px solid #999999;
			height: 54px;
			position: sticky;
			top: 0;
			width: 100%;
			z-index: 100;
		}

		#navigation div {
			margin: 0 auto;
			width: 1000px;
		}

		#navigation div ul {
			list-style: none;
			margin: 0;
			padding: 0;
			overflow: visible;
		}

		#navigation div ul li {
			float: left;
			margin: 0;
			position: relative;
			width: 235px;
		}

		#navigation div ul li a {
			background: none;
			color: #666666;
			display: inline-block;
			font-size: 28px;
			font-weight: bold;
			height: 54px;
			line-height: 54px;
			padding: 0;
			text-decoration: none;
			text-transform: uppercase;
			text-shadow: 0 1px #ffffff;
		}

		#navigation div ul li.current a,
		#navigation div ul li.current a:hover,
		#navigation div ul li a:hover {
			background: url(images/menu-selected.png) no-repeat right center;
			color: #424141;
		}

		#navigation div ul li a.home { padding: 0 28px 0 10px; }
		#navigation div ul li a.about { padding: 0 28px 0 55px; }
		#navigation div ul li a.services { padding: 0 28px 0 110px; }
		#navigation div ul li a.blog { padding: 0 28px 0 140px; }

		.dropdown {
			position: relative;
			display: inline-block;
		}

		.dropdown-content {
			display: none;
			position: absolute;
			background-color: #ffffff;
			width: 170px;
			box-shadow: 0px 8px 16px rgba(0,0,0,0.2);
			z-index: 9999;
			top: 54px;
			left: 0;
			border-radius: 5px;
		}

		.dropdown-content.services-dropdown {
			width: 240px;
			left: 20px;
		}

		.dropdown-content a {
			color: #333 !important;
			padding: 8px 12px !important;
			text-decoration: none !important;
			display: block !important;
			font-size: 20px !important;
			font-weight: normal !important;
			text-transform: none !important;
			text-shadow: none !important;
			background: none !important;
			line-height: normal !important;
			height: auto !important;
		}

		.dropdown-content a:hover {
			background-color: #f1f1f1 !important;
			color: #333 !important;
		}

		.dropdown:hover .dropdown-content {
			display: block;
		}

		/* Body */
		#body {
			background: #cac8c8 url(images/bg-content2.png) repeat-x left top;
			width: 100%;
			min-height: 500px;
		}

		/* Blog Post Full View */
		.blog-post-full {
			max-width: 1600px;
			margin: 40px auto;
			padding: 40px 150px;
			background: white;
			border-radius: 12px;
			box-shadow: 0 4px 20px rgba(0,0,0,0.15);
			overflow-wrap: break-word;
		}

		.blog-post-full h1 {
			color: #2c2c2c;
			font-size: 55px;
			font-weight: bold;
			margin: 0 0 15px 0;
			line-height: 1.3;
		}

		.blog-post-full .date {
			color: #8ab4a8;
			font-size: 21px;
			font-weight: 600;
			margin-bottom: 30px;
			display: block;
			text-transform: uppercase;
			letter-spacing: 0.5px;
		}

		.blog-post-full .featured-image {
			width: 100%;
			max-width: 800px;
			height: auto;
			border-radius: 8px;
			margin: 0 auto 30px auto;
			display: block;
		}

		.blog-post-full .content {
			color: #333;
			font-size: 26px;
			line-height: 1.8;
		}

		.blog-post-full .content p {
			margin-bottom: 20px;
			color: #333;
		}

		.back-link {
			display: inline-block;
			margin: 20px 0;
			color: #8ab4a8;
			text-decoration: none;
			font-size: 18px;
			font-weight: 600;
		}

		.back-link:hover {
			color: #6b9d8f;
		}

		#loading {
			text-align: center;
			color: white;
			font-size: 20px;
			padding: 100px 20px;
		}

		/* Contact & Footer */
		.contact-banner {
			background: #2c2c2c;
			color: white;
			padding: 40px 0;
			width: 100%;
		}

		.contact-content {
			margin: 0 auto;
			max-width: 1200px;
			padding: 0 20px;
		}

		.contact-info h2 {
			color: white;
			font-size: 36px;
			margin: 0 0 30px 0;
			text-align: center;
		}

		.contact-details {
			display: flex;
			justify-content: center;
			gap: 60px;
			flex-wrap: wrap;
		}

		.contact-item {
			text-align: center;
		}

		.contact-item span {
			display: block;
			font-size: 18px;
			line-height: 24px;
		}

		.contact-item .phone {
			font-size: 24px;
			font-weight: bold;
		}

		.contact-item .email {
			font-size: 20px;
			text-decoration: none;
		}

		.contact-item .address {
			font-size: 16px;
			line-height: 22px;
		}

		#footer {
			margin: 0 auto;
			min-height: 85px;
			overflow: hidden;
			width: 940px;
		}

		#footer ul {
			float: left;
			list-style: none;
			margin: 3px 0 0;
			padding: 33px 0 0;
			overflow: hidden;
			width: 220px;
		}

		#footer ul li {
			border-left: 1px solid #85603a;
			float: left;
			height: 10px;
		}

		#footer ul li:first-child {
			border: 0;
		}

		#footer ul li a {
			color: #85603a;
			display: block;
			font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
			font-size: 10px;
			line-height: 9px;
			padding: 0 5px;
			text-align: center;
			text-decoration: none;
		}

		#footer ul li a:hover {
			color: #b6834f;
		}
	</style>
</head>
<body>
	<div id="header">
		<div>
			<a href="index.html" class="logo">Ross Estate Law</a>
		</div>
	</div>
	<div id="navigation">
		<div>
			<ul>
				<li>
					<a class="home" href="index.html">Home</a>
				</li>
				<li class="dropdown">
					<a class="about" href="about.html">About</a>
					<div class="dropdown-content">
						<a href="about.html">Dr. Megan Ross</a>
						<a href="our-process.html">Our Process</a>
					</div>
				</li>
				<li class="dropdown">
					<a class="services" href="estate-planning.html">Services</a>
					<div class="dropdown-content services-dropdown">
						<a href="estate-planning.html">Estate Planning</a>
						<a href="young-families.html">Estate Planning for Young Families</a>
						<a href="probate-services.html">Executor and Probate Services</a>
						<a href="legal-transition.html">Legal Transition Services</a>
					</div>
				</li>
				<li class="current">
					<a class="blog" href="blog.html">Blog</a>
				</li>
			</ul>
		</div>
	</div>
	<div id="body">
		<div id="loading">Loading blog post...</div>
		<div id="blog-post-container"></div>
	</div>
	<div class="contact-banner">
		<div class="contact-content">
			<div class="contact-info">
				<h2>Ross Estate Law</h2>
				<div class="contact-details">
					<div class="contact-item">
						<span class="phone">(902) 403-0008</span>
					</div>
					<div class="contact-item">
						<span class="email">megan@rossestatelaw.ca</span>
					</div>
					<div class="contact-item">
						<span class="address">99 Wyse Road, Suite 1100<br>Dartmouth, Nova Scotia<br>B3A 4S5</span>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div id="footer">
		<ul>
			<li>
				<a href="index.html">Home</a>
			</li>
			<li>
				<a href="about.html">About</a>
			</li>
			<li>
				<a href="estate-planning.html">Services</a>
			</li>
			<li>
				<a href="blog.html">Blog</a>
			</li>
		</ul>
	</div>

	<script>
		// Get post slug from URL
		function getPostSlug() {
			const params = new URLSearchParams(window.location.search);
			return params.get('post');
		}

		// Load and display blog post
		async function loadBlogPost() {
			const slug = getPostSlug();

			if (!slug) {
				document.getElementById('loading').innerHTML = '<p>Blog post not found.</p><a href="blog.html" class="back-link">← Back to Blog</a>';
				return;
			}

			try {
				// Fetch the specific post from GitHub
				const filename = slug + '.md';
				const response = await fetch(`https://api.github.com/repos/theRealSlickFrog/Megan-Ross/contents/_posts/${filename}`);

				if (!response.ok) {
					throw new Error('Post not found');
				}

				const fileData = await response.json();
				const contentResponse = await fetch(fileData.download_url);
				const content = await contentResponse.text();

				const post = parseMarkdownPost(content);

				if (!post) {
					throw new Error('Could not parse post');
				}

				// Update page title
				document.title = `${post.title} - Ross Estate Law`;

				// Display the post
				document.getElementById('loading').style.display = 'none';
				document.getElementById('blog-post-container').innerHTML = `
					<div class="blog-post-full">
						<a href="blog.html" class="back-link">← Back to All Posts</a>
						<h1>${escapeHtml(post.title)}</h1>
						<div class="date">${new Date(post.date).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</div>
						${post.thumbnail ? `<img src="${post.thumbnail}" alt="${escapeHtml(post.title)}" class="featured-image">` : ''}
						<div class="content">${markdownToHtml(post.body)}</div>
						<a href="blog.html" class="back-link">← Back to All Posts</a>
					</div>
				`;

			} catch (error) {
				console.error('Error loading blog post:', error);
				document.getElementById('loading').innerHTML = '<p>Blog post not found.</p><a href="blog.html" class="back-link">← Back to Blog</a>';
			}
		}

		// Parse markdown post file
		function parseMarkdownPost(content) {
			const frontMatterRegex = /^---\s*\n([\s\S]*?)\n---\s*\n([\s\S]*)$/;
			const match = content.match(frontMatterRegex);

			if (!match) return null;

			const frontMatter = match[1];
			const body = match[2];

			const post = { body };

			// Parse front matter
			frontMatter.split('\n').forEach(line => {
				const [key, ...valueParts] = line.split(':');
				if (key && valueParts.length) {
					const value = valueParts.join(':').trim();
					post[key.trim()] = value;
				}
			});

			return post;
		}

		// Simple markdown to HTML converter
		function markdownToHtml(markdown) {
			if (!markdown || markdown.trim() === '') return '<p>No content</p>';

			// Split by double newlines for paragraphs, or single newlines if no double newlines
			const paragraphs = markdown.includes('\n\n')
				? markdown.split('\n\n')
				: markdown.split('\n');

			return paragraphs
				.map(para => para.trim())
				.filter(para => para.length > 0)
				.map(para => {
					// First escape HTML to prevent XSS
					let formatted = escapeHtml(para);

					// Then apply markdown formatting (after escaping)
					// Bold: **text** or __text__
					formatted = formatted.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');
					formatted = formatted.replace(/__(.+?)__/g, '<strong>$1</strong>');

					// Italic: *text* or _text_
					formatted = formatted.replace(/\*(.+?)\*/g, '<em>$1</em>');
					formatted = formatted.replace(/_(.+?)_/g, '<em>$1</em>');

					// Links: [text](url)
					formatted = formatted.replace(/\[(.+?)\]\((.+?)\)/g, '<a href="$2">$1</a>');

					// Replace single line breaks with <br>
					formatted = formatted.replace(/\n/g, '<br>');

					return `<p>${formatted}</p>`;
				})
				.join('');
		}

		// Escape HTML to prevent XSS
		function escapeHtml(text) {
			const div = document.createElement('div');
			div.textContent = text;
			return div.innerHTML;
		}

		// Load post when page loads
		document.addEventListener('DOMContentLoaded', loadBlogPost);
	</script>

</body>
</html>
